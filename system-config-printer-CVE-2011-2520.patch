diff -up system-config-printer-1.1.16/firewall.py.CVE-2011-2520 system-config-printer-1.1.16/firewall.py
--- system-config-printer-1.1.16/firewall.py.CVE-2011-2520	2009-12-03 17:06:22.000000000 +0000
+++ system-config-printer-1.1.16/firewall.py	2011-07-08 11:06:07.375667214 +0100
@@ -22,7 +22,7 @@
 import config
 
 import dbus
-import pickle
+import json
 
 class Firewall:
     def _get_fw_data (self):
@@ -33,7 +33,7 @@ class Firewall:
             iface = dbus.Interface (obj, "org.fedoraproject.Config.Firewall")
             self._firewall = iface
             p = self._firewall.read ()
-            self._fw_data = pickle.loads (p.encode ('utf-8'))
+            self._fw_data = json.loads (p.encode ('utf-8'))
         except dbus.DBusException:
             raise RuntimeError
 
